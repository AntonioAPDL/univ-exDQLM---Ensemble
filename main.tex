\documentclass[11pt]{article}

\usepackage[margin=1in]{geometry}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage{amsmath,amssymb,amsthm,bm,mathtools}
\usepackage[hidelinks]{hyperref}

\newcommand{\R}{\mathbb{R}}
\newcommand{\1}{\mathbb{I}}
\newcommand{\N}{\mathcal{N}}
\newcommand{\IG}{\mathrm{InvGamma}}
\newcommand{\Exp}{\mathrm{Exp}}
\newcommand{\GIG}{\mathrm{GIG}}
\newcommand{\diag}{\mathrm{diag}}
\newcommand{\T}{\mathsf{T}}
\newcommand{\PhiN}{\Phi}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathrm{Var}}

\title{Canonical Univariate exDQLM (Model A): Specification and Computable Updates}
\date{}

\begin{document}
\maketitle

\section{Scope and notation}

This document is restricted to \textbf{univariate Model A} only.
There are no ensemble members, no retrospective discrepancy states, and no multivariate response extension.

For $t=1,\dots,T$:
\begin{itemize}
\item Observation: $y_t\in\R$.
\item Dynamic state: $\bm\theta_t\in\R^q$ with design $\bm F_t\in\R^q$.
\item Transfer component: $\zeta_t\in\R$ and regression effects $\bm\psi_t\in\R^m$ with covariates $\bm x_t\in\R^m$.
\item Quantile level: $p_0\in(0,1)$.
\item exAL parameters: $\sigma>0$, $\gamma\in(L,U)$.
\end{itemize}

\section{Model A hierarchy}

The baseline univariate model is
\begin{align}
y_t \mid \bm\theta_t,\zeta_t,\sigma,\gamma
&\sim \mathrm{exAL}_{p_0}(\bm F_t^\T \bm\theta_t + \zeta_t,\sigma,\gamma), \label{eq:obs}\
\bm\theta_t \mid \bm\theta_{t-1}
&\sim \N(\bm G_t\bm\theta_{t-1},\bm W_t^\theta),\
\zeta_t \mid \zeta_{t-1},\bm\psi_t
&\sim \N(\lambda\zeta_{t-1}+\bm x_t^\T\bm\psi_t,w_t^\zeta),\
\bm\psi_t \mid \bm\psi_{t-1}
&\sim \N(\bm\psi_{t-1},\bm W_t^\psi).
\end{align}

Define stacked state
\[
\bm\alpha_t=(\bm\theta_t^\T,\zeta_t,\bm\psi_t^\T)^\T\in\R^{q+1+m},
\qquad
\tilde{\bm F}_t=\begin{bmatrix}\bm F_t\\1\\\bm 0_m\end{bmatrix},
\]
so $y_t\mid\bm\alpha_t,\sigma,\gamma\sim\mathrm{exAL}_{p_0}(\tilde{\bm F}_t^\T\bm\alpha_t,\sigma,\gamma)$.

\section{exAL augmentation}

For each $t$, introduce $v_t>0$ and $s_t>0$:
\begin{align}
y_t\mid\eta_t,\sigma,\gamma,v_t,s_t
&\sim \N\!\left(\eta_t + C(p,\gamma)\,\sigma|\gamma|s_t + A(p)v_t,\;\sigma B(p)v_t\right),\label{eq:aug_y}\\
v_t\mid\sigma &\sim \Exp(\text{rate}=1/\sigma),\qquad s_t\sim\N^+(0,1),
\end{align}
with $\eta_t=\tilde{\bm F}_t^\T\bm\alpha_t$ and
\begin{align}
g(\gamma)&=2\PhiN(-|\gamma|)\exp(\gamma^2/2),\\
p(p_0,\gamma)&=\1(\gamma<0)+\frac{p_0-\1(\gamma<0)}{g(\gamma)},\\
A(p)&=\frac{1-2p}{p(1-p)},\quad B(p)=\frac{2}{p(1-p)},\quad C(p,\gamma)=\big(\1(\gamma>0)-p\big)^{-1}.
\end{align}

Priors:
\[
\sigma\sim\IG(a_\sigma,b_\sigma),
\qquad
\gamma\sim t_{(L,U)}(m_\gamma,s_\gamma;\nu_\gamma).
\]

\section{Full conditionals (up to proportionality)}

\subsection{Conditional Update for Latent v}

With $r_t=y_t-\eta_t-C\sigma|\gamma|s_t$,
\begin{align}
p(v_t\mid\text{rest})
&\propto v_t^{-1/2}\exp\!\left(-\frac{r_t^2}{2\sigma B}\frac{1}{v_t}-\left(\frac{A^2}{2\sigma B}+\frac{1}{\sigma}\right)v_t\right)\1(v_t>0)\\
&\equiv \GIG\!\left(\lambda=\tfrac12,\chi=\frac{r_t^2}{\sigma B},\psi=\frac{A^2}{\sigma B}+\frac{2}{\sigma}\right).\label{eq:cond_v}
\end{align}

\subsection{Conditional Update for Latent s}

Let $y_t^\circ=y_t-\eta_t-Av_t$, $d=C\sigma|\gamma|$, and $R_t=\sigma Bv_t$.
Then
\[
s_t\mid\text{rest}\sim\N^+(m_{s,t},V_{s,t}),
\]
with
\begin{align}
V_{s,t}&=\left(1+\frac{d^2}{R_t}\right)^{-1}=\left(1+\frac{C^2\sigma\gamma^2}{Bv_t}\right)^{-1},\\
m_{s,t}&=V_{s,t}\left(\frac{d\,y_t^\circ}{R_t}\right)=V_{s,t}\left(\frac{C|\gamma|}{Bv_t}y_t^\circ\right).\label{eq:cond_s}
\end{align}

\subsection{Conditional Update for State Path}

Conditioning on $(v_{1:T},s_{1:T},\sigma,\gamma)$ gives Gaussian pseudo-observations:
\[
\tilde y_t=y_t-C\sigma|\gamma|s_t-Av_t,
\qquad
\tilde y_t\mid\bm\alpha_t\sim\N(\tilde{\bm F}_t^\T\bm\alpha_t,\;R_t),
\qquad
R_t=\sigma Bv_t.
\]
Hence the state-path conditional is Gaussian and can be sampled or optimized by FFBS/Kalman smoothing.

\subsection{Conditional Update for Sigma and Gamma}

For fixed $\gamma$, $\sigma$ has a GIG kernel:
\begin{align}
p(\sigma\mid\text{rest})
\propto
\sigma^{-(a_\sigma+1+\frac{3T}{2})}
\exp\!\left(-\frac{1}{\sigma}\left[b_\sigma+\sum_{t=1}^T v_t+\sum_{t=1}^T\frac{(y_t^\circ)^2}{2Bv_t}\right]-\sigma\left[\sum_{t=1}^T\frac{u_t^2}{2Bv_t}\right]\right),
\end{align}
with $u_t=C|\gamma|s_t$ and $y_t^\circ=y_t-\eta_t-Av_t$.

For $\gamma$, the conditional is nonconjugate due to $p(p_0,\gamma)$ in $(A,B,C)$:
\begin{align}
p(\gamma\mid\text{rest})
\propto
t_{(L,U)}(\gamma\mid m_\gamma,s_\gamma;\nu_\gamma)
\prod_{t=1}^T (\sigma Bv_t)^{-1/2}
\exp\!\left(-\sum_{t=1}^T\frac{(y_t-\eta_t-Av_t-C\sigma|\gamma|s_t)^2}{2\sigma Bv_t}\right).
\label{eq:cond_gamma}
\end{align}

\section{Computable update blocks}

In implementation, use stable operations:
\begin{itemize}
\item Evaluate $K_\nu(\cdot)$ in log or scaled form for GIG moments.
\item Enforce positivity floors for $v_t$, $R_t$, and variances.
\item For $\N^+$ moments, evaluate Mills ratio stably for extreme truncation.
\item Optimize $\gamma$ only inside $(L,U)$ and optimize $\log\sigma$ on $\R$.
\item Use Cholesky/solve routines in the state smoother; avoid explicit matrix inverses.
\end{itemize}

\section{Audit statement}

This manuscript is the canonical univariate-only Model A specification.
All Model B/Model C, ensemble, retrospective, and multivariate components have been retired from the active document.

\end{document}
